<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ç‡∏≠‡∏á‡∏™‡∏π‡∏ç‡∏´‡∏≤‡∏¢</title>
  <style>
    body {
      font-family: "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
      margin: 0;
      padding: 20px;
      background-color: #bc3030;
      color: #333;
    }
    .container {
      max-width: 1200px;
      margin: 0 auto;
      background: #fff;
      border-radius: 8px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      padding: 20px;
      overflow-x: auto;
    }
    h1 {
      text-align: center;
      color: #2c3e50;
      margin-top: 0;
    }
    .form-group { margin-bottom: 15px; }
    label { display: block; margin-bottom: 6px; font-weight: bold; }
    input, select, button {
      width: 100%;
      padding: 10px;
      font-size: 16px;
      border: 1px solid #ccc;
      border-radius: 4px;
      box-sizing: border-box;
    }
    button {
      background-color: #ffd13f;
      color: black;
      cursor: pointer;
      font-weight: bold;
      transition: background-color 0.2s;
    }
    button:hover { background-color: #da8012; }

    /* ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÉ‡∏´‡πâ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤ admin */
    .table-wrapper { overflow-x: auto; }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
      table-layout: auto;
    }
    table th, table td {
      border: 1px solid #ccc;
      padding: 10px;
      text-align: center;
      vertical-align: top;
      white-space: normal;     /* ‡∏ï‡∏±‡∏î‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡πÑ‡∏î‡πâ */
      word-break: break-word;
      overflow-wrap: anywhere;
      hyphens: auto;
      max-width: none;
    }
    table th {
      background-color: #f9f9f9;
      font-weight: bold;
    }
    .status {
      font-weight: bold;
      padding: 5px 10px;
      border-radius: 4px;
      display: inline-block;
      white-space: nowrap;
    }
    .status.waiting { background-color: #28a745; color: #fff; }
    .status.received { background-color: #007bff; color: #fff; }
    .status.expiring { background-color: #ffa500; color: #fff; }
    .status.expired  { background-color: #dc3545; color: #fff; }

    /* Responsive ‡πÉ‡∏´‡πâ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô admin */
    @media (max-width: 768px) {
      .table-wrapper { overflow-x: hidden; }
      table { display: block; }
      table thead { display: none; }
      table tbody tr {
        display: block;
        margin-bottom: 15px;
        background: #fff;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        padding: 15px;
      }
      table td {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 10px 0;
        border: none;
        border-bottom: 1px solid #eee;
      }
      table td:last-child { border-bottom: none; }
      table td::before {
        content: attr(data-label);
        font-weight: bold;
        margin-right: 10px;
        min-width: 120px;
        color: #666;
        text-align: left;
      }
      .status { margin-left: auto; padding: 6px 12px; }
    }
    @media (max-width: 480px) {
      table td::before { min-width: 100px; }
    }

    /* Normalize date/time inputs on iPhone (same height as other inputs) */
    input[type="date"], input[type="time"] {
      -webkit-appearance: none;
      appearance: none;
      height: 44px;
      padding: 10px 12px;
      font-size: 16px;
      line-height: 1.2;
    }
    input[type="date"]::-webkit-date-and-time-value,
    input[type="time"]::-webkit-date-and-time-value {
      text-align: left;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="section" id="searchSection">
      <h1>üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ç‡∏≠‡∏á‡∏´‡∏≤‡∏¢</h1>
      <div class="form-group">
        <label for="searchItemName">‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡πà‡∏á‡∏Ç‡∏≠‡∏á</label>
        <input type="text" id="searchItemName" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏Å‡∏£‡∏∞‡πÄ‡∏õ‡πã‡∏≤, ‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå">
      </div>
      <div class="form-group">
        <label for="searchLocation">‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà</label>
        <input type="text" id="searchLocation" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£ SC3, ‡πÇ‡∏£‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£ SC">
      </div>
      <div class="form-group">
        <label for="searchDate">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</label>
        <input type="date" id="searchDate">
      </div>
      <div class="form-group">
        <label for="searchDetails">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°</label>
        <input type="text" id="searchDetails" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏™‡∏µ‡∏î‡∏≥, ‡∏°‡∏µ‡∏™‡∏ï‡∏¥‡πä‡∏Å‡πÄ‡∏Å‡∏≠‡∏£‡πå‡∏ï‡∏¥‡∏î">
      </div>
      <button id="searchBtn">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</button>
    </div>

    <div id="adminTableContainer" style="margin-top:20px; display:none;">
      <h2>üìã ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</h2>
      <div class="table-wrapper">
        <table>
          <!-- colgroup ‡πÉ‡∏´‡πâ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô admin -->
          <colgroup>
            <col style="width:60px">
            <col style="width:160px">
            <col style="width:100px">
            <col style="width:160px">
            <col style="width:160px">
            <col style="width:260px">
            <col style="width:140px">
            <col style="width:120px">
            <col style="width:180px">
            <col style="width:260px">
            <col style="width:200px">
            <col style="width:140px">
          </colgroup>
          <thead>
            <tr>
              <th>‡∏•‡∏≥‡∏î‡∏±‡∏ö</th>
              <th>‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà (Category)</th>
              <th>‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û (Picture)</th>
              <th>‡∏¢‡∏µ‡πà‡∏´‡πâ‡∏≠ / ‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏ô‡∏ö‡∏±‡∏ï‡∏£ (Brand)</th>
              <th>‡∏£‡∏∏‡πà‡∏ô / ‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£ (Model)</th>
              <th>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° (More Details)</th>
              <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà (Date)</th>
              <th>‡πÄ‡∏ß‡∏•‡∏≤ (Time)</th>
              <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏û‡∏ö (Location)</th>
              <th>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ú‡∏π‡πâ‡πÅ‡∏à‡πâ‡∏á (Reporter Details)</th>
              <th>‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡πÄ‡∏Å‡πá‡∏ö‡πÅ‡∏•‡∏∞‡∏Ñ‡∏£‡∏ö‡∏Å‡∏≥‡∏´‡∏ô‡∏î (Record)</th>
              <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ (Status)</th>
            </tr>
          </thead>
          <tbody id="adminTableBody"></tbody>
        </table>
      </div>

      <div id="notFoundBox" style="display:none; margin-top:16px; text-align:center;">
        <p style="color:#b22222; font-weight:bold;">‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô</p>
        <a href="lost.html">
          <button style="background:#ffd13f; color:#222; font-size:18px; border:none; border-radius:6px; padding:14px 28px; font-weight:bold; cursor:pointer;">
            ‡πÅ‡∏à‡πâ‡∏á‡∏Ç‡∏≠‡∏á‡∏´‡∏≤‡∏¢
          </button>
        </a>
      </div>
    </div>

    <!-- Remove duplicate ‚Äú‡πÅ‡∏à‡πâ‡∏á‡∏Ç‡∏≠‡∏á‡∏´‡∏≤‡∏¢‚Äù button at the bottom -->
    <!-- Delete this block to avoid two buttons after searching -->
    <!--
    <div style="text-align:center; margin-top:40px;">
      <a href="lost.html">
        <button style="
          background:#ffd13f; color:#222; font-size:18px; border:none; border-radius:6px;
          padding:14px 28px; font-weight:bold; cursor:pointer; box-shadow:0 3px 6px rgba(0,0,0,0.2);
          transition: background 0.2s;
        " onmouseover="this.style.background='#da8012'" onmouseout="this.style.background='#ffd13f'">
          ‡πÅ‡∏à‡πâ‡∏á‡∏Ç‡∏≠‡∏á‡∏´‡∏≤‡∏¢
        </button>
      </a>
    </div>
    -->
  </div>

  <script>
    // ‡πÇ‡∏´‡∏•‡∏î‡∏à‡∏≤‡∏Å‡∏ó‡∏±‡πâ‡∏á foundItems ‡πÅ‡∏•‡∏∞ lostItems ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô admin
    function loadFoundRaw() {
      try { return JSON.parse(localStorage.getItem('foundItems')) || []; } catch { return []; }
    }
    function loadLostRaw() {
      try { return JSON.parse(localStorage.getItem('lostItems')) || []; } catch { return []; }
    }
    function normalizeFound(item) {
      return {
        id: item.id, source: 'found',
        category: item.category || '-', brand: item.brand || '-',
        details: item.details || '-', location: item.location || '-',
        date: item.date || '', time: item.time || '',
        status: item.status || 'waiting', itemImage: item.itemImage || '',
        reporterName: item.reporterName || '-', reporterPhone: item.reporterPhone || '-',
        reporterStudentId: item.reporterStudentId || '-'
      };
    }
    function normalizeLost(item) {
      return {
        id: item.id, source: 'lost',
        category: item.itemName || '-', brand: item.brand || '-',
        details: item.description || '-', location: item.location || '-',
        date: item.date || '', time: item.time || '',
        status: item.status || 'waiting', itemImage: item.itemImage || '',
        reporterName: item.reporterName || '-', reporterPhone: item.reporterPhone || '-',
        reporterStudentId: item.reporterStudentId || '-'
      };
    }
    function loadAll() {
      const f = loadFoundRaw().map(normalizeFound);
      const l = loadLostRaw().map(normalizeLost);
      return [...f, ...l].sort((a, b) => (b.id || 0) - (a.id || 0));
    }

    // ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤ admin: lost=‡∏™‡∏π‡∏ç‡∏´‡∏≤‡∏¢, found=‡∏£‡∏≠‡∏£‡∏±‡∏ö‡∏Ñ‡∏∑‡∏ô, received=‡πÑ‡∏î‡πâ‡∏Ñ‡∏∑‡∏ô‡πÅ‡∏•‡πâ‡∏ß
    function getStatusClass(item) {
      return item.status === "received" ? "received" : "waiting";
    }
    function getStatusText(item) {
      const waitingText = (item.source === 'lost') ? '‡∏™‡∏π‡∏ç‡∏´‡∏≤‡∏¢' : '‡∏£‡∏≠‡∏£‡∏±‡∏ö‡∏Ñ‡∏∑‡∏ô';
      return item.status === 'received' ? '‡πÑ‡∏î‡πâ‡∏Ñ‡∏∑‡∏ô‡πÅ‡∏•‡πâ‡∏ß' : waitingText;
    }

    // ‡πÄ‡∏£‡∏ô‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏î‡πâ‡∏ß‡∏¢ data-label ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô admin (‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö mobile)
    function renderAdminTable(items) {
      const tbody = document.getElementById("adminTableBody");
      if (!tbody) return;

      if (!items.length) {
        tbody.innerHTML = "";
        return;
      }

      tbody.innerHTML = items.map((item, index) => `
        <tr>
          <td data-label="‡∏•‡∏≥‡∏î‡∏±‡∏ö">${index + 1}</td>
          <td data-label="‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà (Category)">${item.category}</td>
          <td data-label="‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û (Picture)">
            ${item.itemImage ? `<img src="${item.itemImage}" alt="‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û" style="width:50px;height:50px;object-fit:cover;">` : "‡πÑ‡∏°‡πà‡∏°‡∏µ"}
          </td>
          <td data-label="‡∏¢‡∏µ‡πà‡∏´‡πâ‡∏≠ / ‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏ô‡∏ö‡∏±‡∏ï‡∏£ (Brand)">${item.brand || "-"}</td>
          <td data-label="‡∏£‡∏∏‡πà‡∏ô / ‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£ (Model)">${item.details || "-"}</td>
          <td data-label="‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° (More Details)">${item.details || "-"}</td>
          <td data-label="‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà (Date)">${item.date || "-"}</td>
          <td data-label="‡πÄ‡∏ß‡∏•‡∏≤ (Time)">${item.time || "-"}</td>
          <td data-label="‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏û‡∏ö (Location)">${item.location || "-"}</td>
          <td data-label="‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ú‡∏π‡πâ‡πÅ‡∏à‡πâ‡∏á">
            <div><strong>‡∏ä‡∏∑‡πà‡∏≠:</strong> ${item.reporterName || "-"}</div>
            <div><strong>‡πÇ‡∏ó‡∏£:</strong> ${item.reporterPhone || "-"}</div>
            <div><strong>‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤:</strong> ${item.reporterStudentId || "-"}</div>
          </td>
          <td data-label="‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡πÄ‡∏Å‡πá‡∏ö‡πÅ‡∏•‡∏∞‡∏Ñ‡∏£‡∏ö‡∏Å‡∏≥‡∏´‡∏ô‡∏î (Record)">
            <span style="color:#6b7280;">-</span>
          </td>
          <td data-label="‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ (Status)">
            <span class="status ${getStatusClass(item)}">${getStatusText(item)}</span>
          </td>
        </tr>
      `).join("");
    }

    // ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÅ‡∏•‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•
    document.getElementById("searchBtn").addEventListener("click", function () {
      const itemName = document.getElementById("searchItemName").value.trim().toLowerCase();
      const location = document.getElementById("searchLocation").value.trim().toLowerCase();
      const date = document.getElementById("searchDate").value;
      const details = document.getElementById("searchDetails").value.trim().toLowerCase();

      const all = loadAll();
      const results = all.filter(item =>
        (!itemName || [item.category, item.brand, item.details].some(v => (v || '').toLowerCase().includes(itemName))) &&
        (!location || (item.location || '').toLowerCase().includes(location)) &&
        (!date || item.date === date) &&
        (!details || (item.details || '').toLowerCase().includes(details))
      );

      const container = document.getElementById("adminTableContainer");
      const notFound = document.getElementById("notFoundBox");
      if (results.length > 0) {
        renderAdminTable(results);
        container.style.display = "block";
        if (notFound) notFound.style.display = "none";
      } else {
        document.getElementById("adminTableBody").innerHTML = "";
        container.style.display = "block";
        if (notFound) notFound.style.display = "block";
      }
    });

    // ‡πÅ‡∏™‡∏î‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤ admin ‡∏ó‡∏µ‡πà‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
    (function init() {
      const all = loadAll();
      if (all.length) {
        renderAdminTable(all);
        document.getElementById("adminTableContainer").style.display = "block";
      }
    })();
  </script>
</body>
</html>
